# tools/test_file_utils.py

import logging
from unittest import TestCase

from django.core.cache import cache
from tools.file_utils import get_pds_products

import settings

class fileUtilsTests(TestCase):

    def setUp(self):
        self.maxDiff = None
        settings.OPUS_FAKE_API_DELAYS = 0
        settings.OPUS_FAKE_SERVER_ERROR404_PROBABILITY = 0
        settings.OPUS_FAKE_SERVER_ERROR500_PROBABILITY = 0
        logging.disable(logging.ERROR)
        cache.clear()

    def tearDown(self):
        logging.disable(logging.NOTSET)


            ###############################################
            ######### get_pds_products UNIT TESTS #########
            ###############################################

    def test__get_pds_products_ib4v21gc_opusid_url(self):
        "[test_file_utils.py] get_pds_products: no versions opusid hst-11559-wfc3-ib4v21gc url"
        opus_id = 'hst-11559-wfc3-ib4v21gcq'
        ret = get_pds_products(opus_id)
        expected = {'hst-11559-wfc3-ib4v21gcq': {'Current': {('HST', 10, 'hst_text', 'FITS Header Text'): ['https://opus.pds-rings.seti.org/holdings/volumes/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_21/IB4V21GCQ.ASC', 'https://opus.pds-rings.seti.org/holdings/volumes/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_21/IB4V21GCQ.LBL'], ('HST', 20, 'hst_tiff', 'Raw Data Preview (lossless)'): ['https://opus.pds-rings.seti.org/holdings/volumes/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_21/IB4V21GCQ_RAW.TIF', 'https://opus.pds-rings.seti.org/holdings/volumes/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_21/IB4V21GCQ.LBL'], ('HST', 30, 'hst_raw', 'Raw Data Preview'): ['https://opus.pds-rings.seti.org/holdings/volumes/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_21/IB4V21GCQ_RAW.JPG', 'https://opus.pds-rings.seti.org/holdings/volumes/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_21/IB4V21GCQ.LBL'], ('HST', 40, 'hst_calib', 'Calibrated Data Preview'): ['https://opus.pds-rings.seti.org/holdings/volumes/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_21/IB4V21GCQ_FLT.JPG', 'https://opus.pds-rings.seti.org/holdings/volumes/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_21/IB4V21GCQ.LBL'], ('HST', 70, 'hst_drizzled', 'Calibrated Geometrically Corrected Preview'): ['https://opus.pds-rings.seti.org/holdings/volumes/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_21/IB4V21GCQ_DRZ.JPG', 'https://opus.pds-rings.seti.org/holdings/volumes/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_21/IB4V21GCQ.LBL'], ('HST', 120, 'hst_documentation', 'Documentation'): ['https://opus.pds-rings.seti.org/holdings/documents/HSTIx_xxxx/WFC3-Instrument-Handbook-13.0.pdf', 'https://opus.pds-rings.seti.org/holdings/documents/HSTIx_xxxx/WFC3-Data-Handbook-4.0.pdf', 'https://opus.pds-rings.seti.org/holdings/documents/HSTIx_xxxx/FITS-Standard-4.0.pdf'], ('metadata', 5, 'rms_index', 'RMS Node Augmented Index'): ['https://opus.pds-rings.seti.org/holdings/metadata/HSTIx_xxxx/HSTI1_1559/HSTI1_1559_index.tab', 'https://opus.pds-rings.seti.org/holdings/metadata/HSTIx_xxxx/HSTI1_1559/HSTI1_1559_index.lbl'], ('metadata', 6, 'hstfiles_index', 'HST Files Associations Index'): ['https://opus.pds-rings.seti.org/holdings/metadata/HSTIx_xxxx/HSTI1_1559/HSTI1_1559_hstfiles.tab', 'https://opus.pds-rings.seti.org/holdings/metadata/HSTIx_xxxx/HSTI1_1559/HSTI1_1559_hstfiles.lbl'], ('browse', 10, 'browse_thumb', 'Browse Image (thumbnail)'): ['https://opus.pds-rings.seti.org/holdings/previews/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_21/IB4V21GCQ_thumb.jpg'], ('browse', 20, 'browse_small', 'Browse Image (small)'): ['https://opus.pds-rings.seti.org/holdings/previews/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_21/IB4V21GCQ_small.jpg'], ('browse', 30, 'browse_medium', 'Browse Image (medium)'): ['https://opus.pds-rings.seti.org/holdings/previews/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_21/IB4V21GCQ_med.jpg'], ('browse', 40, 'browse_full', 'Browse Image (full)'): ['https://opus.pds-rings.seti.org/holdings/previews/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_21/IB4V21GCQ_full.jpg']}}}
        print('Got:')
        print(ret)
        print('Expected:')
        print(expected)
        self.assertEqual(dict(ret), dict(expected))

    def test__get_pds_products_ib4v19r3q_opusid_url(self):
        "[test_file_utils.py] get_pds_products: versions opusid hst-11559-wfc3-ib4v19r3q url"
        opus_id = 'hst-11559-wfc3-ib4v19r3q'
        ret = get_pds_products(opus_id)
        expected = {'hst-11559-wfc3-ib4v19r3q': {'Current': {('HST', 10, 'hst_text', 'FITS Header Text'): ['https://opus.pds-rings.seti.org/holdings/volumes/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q.ASC', 'https://opus.pds-rings.seti.org/holdings/volumes/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q.LBL'], ('HST', 20, 'hst_tiff', 'Raw Data Preview (lossless)'): ['https://opus.pds-rings.seti.org/holdings/volumes/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q_RAW.TIF', 'https://opus.pds-rings.seti.org/holdings/volumes/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q.LBL'], ('HST', 30, 'hst_raw', 'Raw Data Preview'): ['https://opus.pds-rings.seti.org/holdings/volumes/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q_RAW.JPG', 'https://opus.pds-rings.seti.org/holdings/volumes/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q.LBL'], ('HST', 40, 'hst_calib', 'Calibrated Data Preview'): ['https://opus.pds-rings.seti.org/holdings/volumes/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q_FLT.JPG', 'https://opus.pds-rings.seti.org/holdings/volumes/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q.LBL'], ('HST', 70, 'hst_drizzled', 'Calibrated Geometrically Corrected Preview'): ['https://opus.pds-rings.seti.org/holdings/volumes/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q_DRZ.JPG', 'https://opus.pds-rings.seti.org/holdings/volumes/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q.LBL'], ('HST', 120, 'hst_documentation', 'Documentation'): ['https://opus.pds-rings.seti.org/holdings/documents/HSTIx_xxxx/WFC3-Instrument-Handbook-13.0.pdf', 'https://opus.pds-rings.seti.org/holdings/documents/HSTIx_xxxx/WFC3-Data-Handbook-4.0.pdf', 'https://opus.pds-rings.seti.org/holdings/documents/HSTIx_xxxx/FITS-Standard-4.0.pdf'], ('metadata', 5, 'rms_index', 'RMS Node Augmented Index'): ['https://opus.pds-rings.seti.org/holdings/metadata/HSTIx_xxxx/HSTI1_1559/HSTI1_1559_index.tab', 'https://opus.pds-rings.seti.org/holdings/metadata/HSTIx_xxxx/HSTI1_1559/HSTI1_1559_index.lbl'], ('metadata', 6, 'hstfiles_index', 'HST Files Associations Index'): ['https://opus.pds-rings.seti.org/holdings/metadata/HSTIx_xxxx/HSTI1_1559/HSTI1_1559_hstfiles.tab', 'https://opus.pds-rings.seti.org/holdings/metadata/HSTIx_xxxx/HSTI1_1559/HSTI1_1559_hstfiles.lbl'], ('browse', 10, 'browse_thumb', 'Browse Image (thumbnail)'): ['https://opus.pds-rings.seti.org/holdings/previews/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q_thumb.jpg'], ('browse', 20, 'browse_small', 'Browse Image (small)'): ['https://opus.pds-rings.seti.org/holdings/previews/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q_small.jpg'], ('browse', 30, 'browse_medium', 'Browse Image (medium)'): ['https://opus.pds-rings.seti.org/holdings/previews/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q_med.jpg'], ('browse', 40, 'browse_full', 'Browse Image (full)'): ['https://opus.pds-rings.seti.org/holdings/previews/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q_full.jpg']}, '1.1': {('HST', 10, 'hst_text', 'FITS Header Text'): ['https://opus.pds-rings.seti.org/holdings/volumes/HSTIx_xxxx_v1.1/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q.ASC', 'https://opus.pds-rings.seti.org/holdings/volumes/HSTIx_xxxx_v1.1/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q.LBL'], ('HST', 20, 'hst_tiff', 'Raw Data Preview (lossless)'): ['https://opus.pds-rings.seti.org/holdings/volumes/HSTIx_xxxx_v1.1/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q_RAW.TIF', 'https://opus.pds-rings.seti.org/holdings/volumes/HSTIx_xxxx_v1.1/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q.LBL'], ('HST', 30, 'hst_raw', 'Raw Data Preview'): ['https://opus.pds-rings.seti.org/holdings/volumes/HSTIx_xxxx_v1.1/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q_RAW.JPG', 'https://opus.pds-rings.seti.org/holdings/volumes/HSTIx_xxxx_v1.1/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q.LBL'], ('HST', 40, 'hst_calib', 'Calibrated Data Preview'): ['https://opus.pds-rings.seti.org/holdings/volumes/HSTIx_xxxx_v1.1/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q_FLT.JPG', 'https://opus.pds-rings.seti.org/holdings/volumes/HSTIx_xxxx_v1.1/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q.LBL'], ('HST', 70, 'hst_drizzled', 'Calibrated Geometrically Corrected Preview'): ['https://opus.pds-rings.seti.org/holdings/volumes/HSTIx_xxxx_v1.1/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q_DRZ.JPG', 'https://opus.pds-rings.seti.org/holdings/volumes/HSTIx_xxxx_v1.1/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q.LBL']}, '1.0': {('HST', 10, 'hst_text', 'FITS Header Text'): ['https://opus.pds-rings.seti.org/holdings/volumes/HSTIx_xxxx_v1.0/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q.ASC', 'https://opus.pds-rings.seti.org/holdings/volumes/HSTIx_xxxx_v1.0/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q.LBL'], ('HST', 20, 'hst_tiff', 'Raw Data Preview (lossless)'): ['https://opus.pds-rings.seti.org/holdings/volumes/HSTIx_xxxx_v1.0/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q_RAW.TIF', 'https://opus.pds-rings.seti.org/holdings/volumes/HSTIx_xxxx_v1.0/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q.LBL'], ('HST', 30, 'hst_raw', 'Raw Data Preview'): ['https://opus.pds-rings.seti.org/holdings/volumes/HSTIx_xxxx_v1.0/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q_RAW.JPG', 'https://opus.pds-rings.seti.org/holdings/volumes/HSTIx_xxxx_v1.0/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q.LBL'], ('HST', 40, 'hst_calib', 'Calibrated Data Preview'): ['https://opus.pds-rings.seti.org/holdings/volumes/HSTIx_xxxx_v1.0/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q_FLT.JPG', 'https://opus.pds-rings.seti.org/holdings/volumes/HSTIx_xxxx_v1.0/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q.LBL'], ('HST', 70, 'hst_drizzled', 'Calibrated Geometrically Corrected Preview'): ['https://opus.pds-rings.seti.org/holdings/volumes/HSTIx_xxxx_v1.0/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q_DRZ.JPG', 'https://opus.pds-rings.seti.org/holdings/volumes/HSTIx_xxxx_v1.0/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q.LBL']}}}
        print('Got:')
        print(ret)
        print('Expected:')
        print(expected)
        self.assertEqual(dict(ret), dict(expected))

    def test__get_pds_products_ib4v21gcq_opusid_path(self):
        "[test_file_utils.py] get_pds_products: no versions opusid hst-11559-wfc3-ib4v21gcq path"
        opus_id = 'hst-11559-wfc3-ib4v21gcq'
        ret = get_pds_products(opus_id, loc_type='path')
        expected = {'hst-11559-wfc3-ib4v21gcq': {'Current': {('HST', 10, 'hst_text', 'FITS Header Text'): [settings.PDS3_DATA_DIR+'/volumes/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_21/IB4V21GCQ.ASC', settings.PDS3_DATA_DIR+'/volumes/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_21/IB4V21GCQ.LBL'], ('HST', 20, 'hst_tiff', 'Raw Data Preview (lossless)'): [settings.PDS3_DATA_DIR+'/volumes/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_21/IB4V21GCQ_RAW.TIF', settings.PDS3_DATA_DIR+'/volumes/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_21/IB4V21GCQ.LBL'], ('HST', 30, 'hst_raw', 'Raw Data Preview'): [settings.PDS3_DATA_DIR+'/volumes/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_21/IB4V21GCQ_RAW.JPG', settings.PDS3_DATA_DIR+'/volumes/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_21/IB4V21GCQ.LBL'], ('HST', 40, 'hst_calib', 'Calibrated Data Preview'): [settings.PDS3_DATA_DIR+'/volumes/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_21/IB4V21GCQ_FLT.JPG', settings.PDS3_DATA_DIR+'/volumes/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_21/IB4V21GCQ.LBL'], ('HST', 70, 'hst_drizzled', 'Calibrated Geometrically Corrected Preview'): [settings.PDS3_DATA_DIR+'/volumes/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_21/IB4V21GCQ_DRZ.JPG', settings.PDS3_DATA_DIR+'/volumes/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_21/IB4V21GCQ.LBL'], ('HST', 120, 'hst_documentation', 'Documentation'): [settings.PDS3_DATA_DIR+'/documents/HSTIx_xxxx/WFC3-Instrument-Handbook-13.0.pdf', settings.PDS3_DATA_DIR+'/documents/HSTIx_xxxx/WFC3-Data-Handbook-4.0.pdf', settings.PDS3_DATA_DIR+'/documents/HSTIx_xxxx/FITS-Standard-4.0.pdf'], ('metadata', 5, 'rms_index', 'RMS Node Augmented Index'): [settings.PDS3_DATA_DIR+'/metadata/HSTIx_xxxx/HSTI1_1559/HSTI1_1559_index.tab', settings.PDS3_DATA_DIR+'/metadata/HSTIx_xxxx/HSTI1_1559/HSTI1_1559_index.lbl'], ('metadata', 6, 'hstfiles_index', 'HST Files Associations Index'): [settings.PDS3_DATA_DIR+'/metadata/HSTIx_xxxx/HSTI1_1559/HSTI1_1559_hstfiles.tab', settings.PDS3_DATA_DIR+'/metadata/HSTIx_xxxx/HSTI1_1559/HSTI1_1559_hstfiles.lbl'], ('browse', 10, 'browse_thumb', 'Browse Image (thumbnail)'): [settings.PDS3_DATA_DIR+'/previews/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_21/IB4V21GCQ_thumb.jpg'], ('browse', 20, 'browse_small', 'Browse Image (small)'): [settings.PDS3_DATA_DIR+'/previews/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_21/IB4V21GCQ_small.jpg'], ('browse', 30, 'browse_medium', 'Browse Image (medium)'): [settings.PDS3_DATA_DIR+'/previews/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_21/IB4V21GCQ_med.jpg'], ('browse', 40, 'browse_full', 'Browse Image (full)'): [settings.PDS3_DATA_DIR+'/previews/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_21/IB4V21GCQ_full.jpg']}}}
        print(ret)
        print('Expected:')
        print(expected)
        self.assertEqual(dict(ret), dict(expected))

    def test__get_pds_products_ib4v19r3q_opusid_path(self):
        "[test_file_utils.py] get_pds_products: versions opusid hst-11559-wfc3-ib4v19r3q path"
        opus_id = 'hst-11559-wfc3-ib4v19r3q'
        ret = get_pds_products(opus_id, loc_type='path')
        expected = {'hst-11559-wfc3-ib4v19r3q': {'Current': {('HST', 10, 'hst_text', 'FITS Header Text'): [settings.PDS3_DATA_DIR+'/volumes/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q.ASC', settings.PDS3_DATA_DIR+'/volumes/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q.LBL'], ('HST', 20, 'hst_tiff', 'Raw Data Preview (lossless)'): [settings.PDS3_DATA_DIR+'/volumes/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q_RAW.TIF', settings.PDS3_DATA_DIR+'/volumes/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q.LBL'], ('HST', 30, 'hst_raw', 'Raw Data Preview'): [settings.PDS3_DATA_DIR+'/volumes/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q_RAW.JPG', settings.PDS3_DATA_DIR+'/volumes/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q.LBL'], ('HST', 40, 'hst_calib', 'Calibrated Data Preview'): [settings.PDS3_DATA_DIR+'/volumes/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q_FLT.JPG', settings.PDS3_DATA_DIR+'/volumes/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q.LBL'], ('HST', 70, 'hst_drizzled', 'Calibrated Geometrically Corrected Preview'): [settings.PDS3_DATA_DIR+'/volumes/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q_DRZ.JPG', settings.PDS3_DATA_DIR+'/volumes/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q.LBL'], ('HST', 120, 'hst_documentation', 'Documentation'): [settings.PDS3_DATA_DIR+'/documents/HSTIx_xxxx/WFC3-Instrument-Handbook-13.0.pdf', settings.PDS3_DATA_DIR+'/documents/HSTIx_xxxx/WFC3-Data-Handbook-4.0.pdf', settings.PDS3_DATA_DIR+'/documents/HSTIx_xxxx/FITS-Standard-4.0.pdf'], ('metadata', 5, 'rms_index', 'RMS Node Augmented Index'): [settings.PDS3_DATA_DIR+'/metadata/HSTIx_xxxx/HSTI1_1559/HSTI1_1559_index.tab', settings.PDS3_DATA_DIR+'/metadata/HSTIx_xxxx/HSTI1_1559/HSTI1_1559_index.lbl'], ('metadata', 6, 'hstfiles_index', 'HST Files Associations Index'): [settings.PDS3_DATA_DIR+'/metadata/HSTIx_xxxx/HSTI1_1559/HSTI1_1559_hstfiles.tab', settings.PDS3_DATA_DIR+'/metadata/HSTIx_xxxx/HSTI1_1559/HSTI1_1559_hstfiles.lbl'], ('browse', 10, 'browse_thumb', 'Browse Image (thumbnail)'): [settings.PDS3_DATA_DIR+'/previews/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q_thumb.jpg'], ('browse', 20, 'browse_small', 'Browse Image (small)'): [settings.PDS3_DATA_DIR+'/previews/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q_small.jpg'], ('browse', 30, 'browse_medium', 'Browse Image (medium)'): [settings.PDS3_DATA_DIR+'/previews/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q_med.jpg'], ('browse', 40, 'browse_full', 'Browse Image (full)'): [settings.PDS3_DATA_DIR+'/previews/HSTIx_xxxx/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q_full.jpg']}, '1.1': {('HST', 10, 'hst_text', 'FITS Header Text'): [settings.PDS3_DATA_DIR+'/volumes/HSTIx_xxxx_v1.1/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q.ASC', settings.PDS3_DATA_DIR+'/volumes/HSTIx_xxxx_v1.1/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q.LBL'], ('HST', 20, 'hst_tiff', 'Raw Data Preview (lossless)'): [settings.PDS3_DATA_DIR+'/volumes/HSTIx_xxxx_v1.1/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q_RAW.TIF', settings.PDS3_DATA_DIR+'/volumes/HSTIx_xxxx_v1.1/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q.LBL'], ('HST', 30, 'hst_raw', 'Raw Data Preview'): [settings.PDS3_DATA_DIR+'/volumes/HSTIx_xxxx_v1.1/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q_RAW.JPG', settings.PDS3_DATA_DIR+'/volumes/HSTIx_xxxx_v1.1/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q.LBL'], ('HST', 40, 'hst_calib', 'Calibrated Data Preview'): [settings.PDS3_DATA_DIR+'/volumes/HSTIx_xxxx_v1.1/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q_FLT.JPG', settings.PDS3_DATA_DIR+'/volumes/HSTIx_xxxx_v1.1/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q.LBL'], ('HST', 70, 'hst_drizzled', 'Calibrated Geometrically Corrected Preview'): [settings.PDS3_DATA_DIR+'/volumes/HSTIx_xxxx_v1.1/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q_DRZ.JPG', settings.PDS3_DATA_DIR+'/volumes/HSTIx_xxxx_v1.1/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q.LBL']}, '1.0': {('HST', 10, 'hst_text', 'FITS Header Text'): [settings.PDS3_DATA_DIR+'/volumes/HSTIx_xxxx_v1.0/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q.ASC', settings.PDS3_DATA_DIR+'/volumes/HSTIx_xxxx_v1.0/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q.LBL'], ('HST', 20, 'hst_tiff', 'Raw Data Preview (lossless)'): [settings.PDS3_DATA_DIR+'/volumes/HSTIx_xxxx_v1.0/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q_RAW.TIF', settings.PDS3_DATA_DIR+'/volumes/HSTIx_xxxx_v1.0/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q.LBL'], ('HST', 30, 'hst_raw', 'Raw Data Preview'): [settings.PDS3_DATA_DIR+'/volumes/HSTIx_xxxx_v1.0/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q_RAW.JPG', settings.PDS3_DATA_DIR+'/volumes/HSTIx_xxxx_v1.0/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q.LBL'], ('HST', 40, 'hst_calib', 'Calibrated Data Preview'): [settings.PDS3_DATA_DIR+'/volumes/HSTIx_xxxx_v1.0/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q_FLT.JPG', settings.PDS3_DATA_DIR+'/volumes/HSTIx_xxxx_v1.0/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q.LBL'], ('HST', 70, 'hst_drizzled', 'Calibrated Geometrically Corrected Preview'): [settings.PDS3_DATA_DIR+'/volumes/HSTIx_xxxx_v1.0/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q_DRZ.JPG', settings.PDS3_DATA_DIR+'/volumes/HSTIx_xxxx_v1.0/HSTI1_1559/DATA/VISIT_19/IB4V19R3Q.LBL']}}}
        print('Got:')
        print(ret)
        print('Expected:')
        print(expected)
        self.assertEqual(dict(ret), dict(expected))

    def test__get_pds_products_kao0m91_occ_opusid_path(self):
        "[test_file_utils.py] get_pds_products: opusid kao0m91-vis-occ-1977-069-u0-epsilon-i path"
        opus_id = 'kao0m91-vis-occ-1977-069-u0-epsilon-i'
        ret = get_pds_products(opus_id, loc_type='path')
        expected = {'kao0m91-vis-occ-1977-069-u0-epsilon-i': {'Current': {('Uranus Earth-based Occultations', 10, 'ebur_occ_ring_0100', 'Occultation Ring Profile (100 m)'): [settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_u0_kao_91cm/data/rings/u0_kao_91cm_734nm_radius_epsilon_ingress_100m.xml', settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_u0_kao_91cm/data/rings/u0_kao_91cm_734nm_radius_epsilon_ingress_100m.tab'], ('Uranus Earth-based Occultations', 20, 'ebur_occ_ring_0500', 'Occultation Ring Profile (500 m)'): [settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_u0_kao_91cm/data/rings/u0_kao_91cm_734nm_radius_epsilon_ingress_500m.xml', settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_u0_kao_91cm/data/rings/u0_kao_91cm_734nm_radius_epsilon_ingress_500m.tab'], ('Uranus Earth-based Occultations', 30, 'ebur_occ_ring_1000', 'Occultation Ring Profile (1 km)'): [settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_u0_kao_91cm/data/rings/u0_kao_91cm_734nm_radius_epsilon_ingress_1000m.xml', settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_u0_kao_91cm/data/rings/u0_kao_91cm_734nm_radius_epsilon_ingress_1000m.tab'], ('Uranus Earth-based Occultations', 40, 'ebur_occ_ring_time', 'Occultation Ring Time Series'): [settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_u0_kao_91cm/data/rings/u0_kao_91cm_734nm_counts-v-time_rings_ingress.xml', settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_u0_kao_91cm/data/rings/u0_kao_91cm_734nm_counts-v-time_rings_ingress.tab'], ('Uranus Earth-based Occultations', 50, 'ebur_occ_ring_sqw_model', 'Occultation Ring Model'): [settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_u0_kao_91cm/data/ring_models/u0_kao_91cm_734nm_wavelengths.xml', settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_u0_kao_91cm/data/ring_models/u0_kao_91cm_734nm_wavelengths.csv', settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_u0_kao_91cm/data/ring_models/u0_kao_91cm_734nm_ring_epsilon_ingress_sqw_s.tab', settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_u0_kao_91cm/data/ring_models/u0_kao_91cm_734nm_ring_epsilon_ingress_sqw_p.tab', settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_u0_kao_91cm/data/ring_models/u0_kao_91cm_734nm_ring_epsilon_ingress_sqw_i.tab', settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_u0_kao_91cm/data/ring_models/u0_kao_91cm_734nm_ring_epsilon_ingress_sqw_h.tab', settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_u0_kao_91cm/data/ring_models/u0_kao_91cm_734nm_ring_epsilon_ingress_sqw_c.tab', settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_u0_kao_91cm/data/ring_models/u0_kao_91cm_734nm_ring_epsilon_ingress_sqw.xml', settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_u0_kao_91cm/data/ring_models/u0_kao_91cm_734nm_ring_epsilon_ingress_sqw.txt', settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_u0_kao_91cm/data/ring_models/u0_kao_91cm_734nm_ring_epsilon_ingress_sqw.pdf', settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_u0_kao_91cm/data/ring_models/u0_kao_91cm_734nm_predicted_ring_event_times.xml', settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_u0_kao_91cm/data/ring_models/u0_kao_91cm_734nm_predicted_ring_event_times.tab', settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_u0_kao_91cm/data/ring_models/u0_kao_91cm_734nm_predicted_ring_event_times.pdf', settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_u0_kao_91cm/data/ring_models/u0_kao_91cm_734nm_fitted_ring_event_times.xml', settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_u0_kao_91cm/data/ring_models/u0_kao_91cm_734nm_fitted_ring_event_times.tab'], ('Uranus Earth-based Occultations', 110, 'ebur_occ_global_ring_fit', 'Global Ring Orbital Fit'): [settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_support/data/uranus_occultation_ring_fit_rfrench_input_stars_20201201.csv', settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_support/data/uranus_occultation_ring_fit_rfrench_input_observatories_20201201.tab', settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_support/data/uranus_occultation_ring_fit_rfrench_input_events_20201201.tab', settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_support/data/uranus_occultation_ring_fit_rfrench_input_data_20201201.tab', settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_support/data/uranus_occultation_ring_fit_rfrench_20201201.xml', settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_support/data/uranus_occultation_ring_fit_rfrench_20201201.txt', settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_support/data/uranus_occultation_ring_fit_rfrench_20201201.tab'], ('Uranus Earth-based Occultations', 120, 'ebur_occ_orig_index', 'Original Index'): [settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_support/document/supplemental_docs/uranus_occultations_index.xml', settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_support/document/supplemental_docs/uranus_occultations_index.tab'], ('Uranus Earth-based Occultations', 130, 'ebur_occ_quality_rating', 'Quality Ratings'): [settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_support/document/supplemental_docs/uranus_ringocc_bundles_quality_rating.xml', settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_support/document/supplemental_docs/uranus_ringocc_bundles_quality_rating.csv'], ('Uranus Earth-based Occultations', 150, 'ebur_occ_documentation', 'Documentation'): [settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_support/document/user_guide/earth-based-uranus-stellar-occultation-user-guide.xml', settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_support/document/user_guide/earth-based-uranus-stellar-occultation-user-guide.pdf'], ('Uranus Earth-based Occultations', 160, 'ebur_occ_software', 'Software'): [settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_support/document/user_guide/ring_longitude_example.py', settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_support/document/user_guide/ring_longitude_example.pro', settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_support/document/user_guide/plot_epsilon_ring_example_python.pdf', settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_support/document/user_guide/plot_epsilon_ring_example_IDL.pdf', settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_support/document/user_guide/plot_epsilon_ring_example.py', settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_support/document/user_guide/plot_epsilon_ring_example.pro', settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_support/document/user_guide/occgeom_example2.py', settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_support/document/user_guide/occgeom_example2.pro', settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_support/document/user_guide/occgeom_example1.py', settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_support/document/user_guide/occgeom_example1.pro', settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_support/document/user_guide/create_uranus_ringframes_french_et_al_1988_v1.pro', settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_support/document/user_guide/UranusPoleExample2.py', settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_support/document/user_guide/UranusPoleExample1.py'], ('Uranus Earth-based Occultations', 170, 'ebur_occ_kernels', 'SPICE Kernels'): [settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_support/spice_kernels/spk/urkao_v1.xml', settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_support/spice_kernels/spk/urkao_v1.bsp', settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_support/spice_kernels/fk/uranus_ringframes_rfrench20201201_v1.xml', settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_support/spice_kernels/fk/uranus_ringframes_rfrench20201201_v1.tf', settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_support/spice_kernels/fk/uranus_ringframes_french_et_al_1988_v1.xml', settings.PDS4_DATA_DIR+'/bundles/uranus_occs_earthbased/uranus_occ_support/spice_kernels/fk/uranus_ringframes_french_et_al_1988_v1.tf'], ('metadata', 5, 'rms_index', 'RMS Node Augmented Index'): [settings.PDS4_DATA_DIR+'/metadata/uranus_occs_earthbased/uranus_occ_u0_kao_91cm/uranus_occ_u0_kao_91cm_rings_index.csv'], ('diagram', 10, 'diagram_thumb', 'Browse Diagram (thumbnail)'): [settings.PDS4_DATA_DIR+'/diagrams/uranus_occs_earthbased/uranus_occ_u0_kao_91cm/data/rings/u0_kao_91cm_734nm_radius_epsilon_ingress_diagram_thumb.png'], ('diagram', 20, 'diagram_small', 'Browse Diagram (small)'): [settings.PDS4_DATA_DIR+'/diagrams/uranus_occs_earthbased/uranus_occ_u0_kao_91cm/data/rings/u0_kao_91cm_734nm_radius_epsilon_ingress_diagram_small.png'], ('diagram', 30, 'diagram_medium', 'Browse Diagram (medium)'): [settings.PDS4_DATA_DIR+'/diagrams/uranus_occs_earthbased/uranus_occ_u0_kao_91cm/data/rings/u0_kao_91cm_734nm_radius_epsilon_ingress_diagram_med.png'], ('diagram', 40, 'diagram_full', 'Browse Diagram (full)'): [settings.PDS4_DATA_DIR+'/diagrams/uranus_occs_earthbased/uranus_occ_u0_kao_91cm/data/rings/u0_kao_91cm_734nm_radius_epsilon_ingress_diagram_full.png']}}}
        print('Got:')
        print(ret)
        print('Expected:')
        print(expected)
        self.assertEqual(dict(ret), dict(expected))

    def test__get_pds_products_multiple_opusid(self):
        "[test_file_utils.py] get_pds_products: versions multiple opusids path"
        opus_id_list = ['co-iss-n1460960868',
                        'co-uvis-euv2001_001_02_12',
                        'co-vims-v1484504505_ir',
                        'vg-iss-2-s-c4360048']
        ret = get_pds_products(opus_id_list, loc_type='path')
        expected = {'co-iss-n1460960868': {'Current': {('Cassini ISS', 0, 'coiss_raw', 'Raw Image'): [settings.PDS3_DATA_DIR+'/volumes/COISS_2xxx/COISS_2002/data/1460960653_1461048959/N1460960868_1.IMG', settings.PDS3_DATA_DIR+'/volumes/COISS_2xxx/COISS_2002/data/1460960653_1461048959/N1460960868_1.LBL', settings.PDS3_DATA_DIR+'/volumes/COISS_2xxx/COISS_2002/label/prefix2.fmt', settings.PDS3_DATA_DIR+'/volumes/COISS_2xxx/COISS_2002/label/tlmtab.fmt'], ('Cassini ISS', 10, 'coiss_calib', 'Calibrated Image'): [settings.PDS3_DATA_DIR+'/calibrated/COISS_2xxx/COISS_2002/data/1460960653_1461048959/N1460960868_1_CALIB.IMG', settings.PDS3_DATA_DIR+'/calibrated/COISS_2xxx/COISS_2002/data/1460960653_1461048959/N1460960868_1_CALIB.LBL'], ('Cassini ISS', 110, 'coiss_thumb', 'Extra Preview (thumbnail)'): [settings.PDS3_DATA_DIR+'/volumes/COISS_2xxx/COISS_2002/extras/thumbnail/1460960653_1461048959/N1460960868_1.IMG.jpeg_small'], ('Cassini ISS', 120, 'coiss_medium', 'Extra Preview (medium)'): [settings.PDS3_DATA_DIR+'/volumes/COISS_2xxx/COISS_2002/extras/browse/1460960653_1461048959/N1460960868_1.IMG.jpeg'], ('Cassini ISS', 130, 'coiss_full', 'Extra Preview (full)'): [settings.PDS3_DATA_DIR+'/volumes/COISS_2xxx/COISS_2002/extras/full/1460960653_1461048959/N1460960868_1.IMG.png'], ('Cassini ISS', 140, 'coiss_documentation', 'Documentation'): [settings.PDS3_DATA_DIR+'/documents/COISS_0xxx/VICAR-File-Format.pdf', settings.PDS3_DATA_DIR+'/documents/COISS_0xxx/ISS-Users-Guide.pdf', settings.PDS3_DATA_DIR+'/documents/COISS_0xxx/ISS-Users-Guide.docx', settings.PDS3_DATA_DIR+'/documents/COISS_0xxx/Data-Product-SIS.txt', settings.PDS3_DATA_DIR+'/documents/COISS_0xxx/Data-Product-SIS.pdf', settings.PDS3_DATA_DIR+'/documents/COISS_0xxx/Cassini-ISS-Final-Report.pdf', settings.PDS3_DATA_DIR+'/documents/COISS_0xxx/Calibration-Theoretical-Basis.pdf', settings.PDS3_DATA_DIR+'/documents/COISS_0xxx/Calibration-Plan.pdf', settings.PDS3_DATA_DIR+'/documents/COISS_0xxx/CISSCAL-Users-Guide.pdf', settings.PDS3_DATA_DIR+'/documents/COISS_0xxx/Archive-SIS.txt', settings.PDS3_DATA_DIR+'/documents/COISS_0xxx/Archive-SIS.pdf'], ('metadata', 5, 'rms_index', 'RMS Node Augmented Index'): [settings.PDS3_DATA_DIR+'/metadata/COISS_2xxx/COISS_2002/COISS_2002_index.tab', settings.PDS3_DATA_DIR+'/metadata/COISS_2xxx/COISS_2002/COISS_2002_index.lbl'], ('metadata', 10, 'inventory', 'Target Body Inventory'): [settings.PDS3_DATA_DIR+'/metadata/COISS_2xxx/COISS_2002/COISS_2002_inventory.csv', settings.PDS3_DATA_DIR+'/metadata/COISS_2xxx/COISS_2002/COISS_2002_inventory.lbl'], ('metadata', 20, 'planet_geometry', 'Planet Geometry Index'): [settings.PDS3_DATA_DIR+'/metadata/COISS_2xxx/COISS_2002/COISS_2002_saturn_summary.tab', settings.PDS3_DATA_DIR+'/metadata/COISS_2xxx/COISS_2002/COISS_2002_saturn_summary.lbl'], ('metadata', 30, 'moon_geometry', 'Moon Geometry Index'): [settings.PDS3_DATA_DIR+'/metadata/COISS_2xxx/COISS_2002/COISS_2002_moon_summary.tab', settings.PDS3_DATA_DIR+'/metadata/COISS_2xxx/COISS_2002/COISS_2002_moon_summary.lbl'], ('metadata', 50, 'ring_geometry', 'Ring Geometry Index'): [settings.PDS3_DATA_DIR+'/metadata/COISS_2xxx/COISS_2002/COISS_2002_ring_summary.tab', settings.PDS3_DATA_DIR+'/metadata/COISS_2xxx/COISS_2002/COISS_2002_ring_summary.lbl'], ('browse', 10, 'browse_thumb', 'Browse Image (thumbnail)'): [settings.PDS3_DATA_DIR+'/previews/COISS_2xxx/COISS_2002/data/1460960653_1461048959/N1460960868_1_thumb.jpg'], ('browse', 20, 'browse_small', 'Browse Image (small)'): [settings.PDS3_DATA_DIR+'/previews/COISS_2xxx/COISS_2002/data/1460960653_1461048959/N1460960868_1_small.jpg'], ('browse', 30, 'browse_medium', 'Browse Image (medium)'): [settings.PDS3_DATA_DIR+'/previews/COISS_2xxx/COISS_2002/data/1460960653_1461048959/N1460960868_1_med.jpg'], ('browse', 40, 'browse_full', 'Browse Image (full)'): [settings.PDS3_DATA_DIR+'/previews/COISS_2xxx/COISS_2002/data/1460960653_1461048959/N1460960868_1_full.png']}, '2': {('Cassini ISS', 10, 'coiss_calib', 'Calibrated Image'): [settings.PDS3_DATA_DIR+'/calibrated/COISS_2xxx_v2/COISS_2002/data/1460960653_1461048959/N1460960868_1_CALIB.IMG', settings.PDS3_DATA_DIR+'/calibrated/COISS_2xxx_v2/COISS_2002/data/1460960653_1461048959/N1460960868_1_CALIB.LBL']}, '1': {('Cassini ISS', 10, 'coiss_calib', 'Calibrated Image'): [settings.PDS3_DATA_DIR+'/calibrated/COISS_2xxx_v1/COISS_2002/data/1460960653_1461048959/N1460960868_1_CALIB.IMG', settings.PDS3_DATA_DIR+'/calibrated/COISS_2xxx_v1/COISS_2002/data/1460960653_1461048959/N1460960868_1_CALIB.LBL']}}, 'co-uvis-euv2001_001_02_12': {'Current': {('Cassini UVIS', 10, 'couvis_raw', 'Raw Data'): [settings.PDS3_DATA_DIR+'/volumes/COUVIS_0xxx/COUVIS_0002/DATA/D2001_001/EUV2001_001_02_12.DAT', settings.PDS3_DATA_DIR+'/volumes/COUVIS_0xxx/COUVIS_0002/DATA/D2001_001/EUV2001_001_02_12.LBL'], ('Cassini UVIS', 20, 'couvis_calib_corr', 'Calibration Data'): [settings.PDS3_DATA_DIR+'/volumes/COUVIS_0xxx/COUVIS_0002/CALIB/VERSION_3/D2001_001/EUV2001_001_02_12_CAL_3.DAT', settings.PDS3_DATA_DIR+'/volumes/COUVIS_0xxx/COUVIS_0002/CALIB/VERSION_3/D2001_001/EUV2001_001_02_12_CAL_3.LBL'], ('Cassini UVIS', 30, 'couvis_documentation', 'Documentation'): [settings.PDS3_DATA_DIR+'/documents/COUVIS_0xxx/UVIS-Users-Guide.pdf', settings.PDS3_DATA_DIR+'/documents/COUVIS_0xxx/UVIS-Users-Guide.docx', settings.PDS3_DATA_DIR+'/documents/COUVIS_0xxx/UVIS-Preview-Interpretation-Guide.txt', settings.PDS3_DATA_DIR+'/documents/COUVIS_0xxx/UVIS-Archive-SIS.txt', settings.PDS3_DATA_DIR+'/documents/COUVIS_0xxx/UVIS-Archive-SIS.pdf', settings.PDS3_DATA_DIR+'/documents/COUVIS_0xxx/Cassini-UVIS-Final-Report.pdf'], ('metadata', 5, 'rms_index', 'RMS Node Augmented Index'): [settings.PDS3_DATA_DIR+'/metadata/COUVIS_0xxx/COUVIS_0002/COUVIS_0002_index.tab', settings.PDS3_DATA_DIR+'/metadata/COUVIS_0xxx/COUVIS_0002/COUVIS_0002_index.lbl'], ('metadata', 8, 'supplemental_index', 'Supplemental Index'): [settings.PDS3_DATA_DIR+'/metadata/COUVIS_0xxx/COUVIS_0002/COUVIS_0002_supplemental_index.tab', settings.PDS3_DATA_DIR+'/metadata/COUVIS_0xxx/COUVIS_0002/COUVIS_0002_supplemental_index.lbl'], ('browse', 10, 'browse_thumb', 'Browse Image (thumbnail)'): [settings.PDS3_DATA_DIR+'/previews/COUVIS_0xxx/COUVIS_0002/DATA/D2001_001/EUV2001_001_02_12_thumb.png'], ('browse', 20, 'browse_small', 'Browse Image (small)'): [settings.PDS3_DATA_DIR+'/previews/COUVIS_0xxx/COUVIS_0002/DATA/D2001_001/EUV2001_001_02_12_small.png'], ('browse', 30, 'browse_medium', 'Browse Image (medium)'): [settings.PDS3_DATA_DIR+'/previews/COUVIS_0xxx/COUVIS_0002/DATA/D2001_001/EUV2001_001_02_12_med.png'], ('browse', 40, 'browse_full', 'Browse Image (full)'): [settings.PDS3_DATA_DIR+'/previews/COUVIS_0xxx/COUVIS_0002/DATA/D2001_001/EUV2001_001_02_12_full.png']}}, 'co-vims-v1484504505_ir': {'Current': {('Cassini VIMS', 0, 'covims_raw', 'Raw Cube'): [settings.PDS3_DATA_DIR+'/volumes/COVIMS_0xxx/COVIMS_0006/data/2005015T175855_2005016T184233/v1484504505_4.qub', settings.PDS3_DATA_DIR+'/volumes/COVIMS_0xxx/COVIMS_0006/data/2005015T175855_2005016T184233/v1484504505_4.lbl', settings.PDS3_DATA_DIR+'/volumes/COVIMS_0xxx/COVIMS_0006/label/band_bin_center.fmt', settings.PDS3_DATA_DIR+'/volumes/COVIMS_0xxx/COVIMS_0006/label/core_description.fmt', settings.PDS3_DATA_DIR+'/volumes/COVIMS_0xxx/COVIMS_0006/label/suffix_description.fmt'], ('Cassini VIMS', 110, 'covims_thumb', 'Extra Preview (thumbnail)'): [settings.PDS3_DATA_DIR+'/volumes/COVIMS_0xxx/COVIMS_0006/extras/thumbnail/2005015T175855_2005016T184233/v1484504505_4.qub.jpeg_small'], ('Cassini VIMS', 120, 'covims_medium', 'Extra Preview (medium)'): [settings.PDS3_DATA_DIR+'/volumes/COVIMS_0xxx/COVIMS_0006/extras/browse/2005015T175855_2005016T184233/v1484504505_4.qub.jpeg'], ('Cassini VIMS', 130, 'covims_full', 'Extra Preview (full)'): [settings.PDS3_DATA_DIR+'/volumes/COVIMS_0xxx/COVIMS_0006/extras/tiff/2005015T175855_2005016T184233/v1484504505_4.qub.tiff'], ('Cassini VIMS', 140, 'covims_documentation', 'Documentation'): [settings.PDS3_DATA_DIR+'/documents/COVIMS_0xxx/VIMS-Preview-Interpretation-Guide.pdf', settings.PDS3_DATA_DIR+'/documents/COVIMS_0xxx/Data-Product-SIS.txt', settings.PDS3_DATA_DIR+'/documents/COVIMS_0xxx/Cassini-VIMS-Final-Report.pdf', settings.PDS3_DATA_DIR+'/documents/COVIMS_0xxx/Archive-SIS.txt'], ('metadata', 5, 'rms_index', 'RMS Node Augmented Index'): [settings.PDS3_DATA_DIR+'/metadata/COVIMS_0xxx/COVIMS_0006/COVIMS_0006_index.tab', settings.PDS3_DATA_DIR+'/metadata/COVIMS_0xxx/COVIMS_0006/COVIMS_0006_index.lbl'], ('metadata', 8, 'supplemental_index', 'Supplemental Index'): [settings.PDS3_DATA_DIR+'/metadata/COVIMS_0xxx/COVIMS_0006/COVIMS_0006_supplemental_index.tab', settings.PDS3_DATA_DIR+'/metadata/COVIMS_0xxx/COVIMS_0006/COVIMS_0006_supplemental_index.lbl'], ('metadata', 10, 'inventory', 'Target Body Inventory'): [settings.PDS3_DATA_DIR+'/metadata/COVIMS_0xxx/COVIMS_0006/COVIMS_0006_inventory.csv', settings.PDS3_DATA_DIR+'/metadata/COVIMS_0xxx/COVIMS_0006/COVIMS_0006_inventory.lbl'], ('browse', 10, 'browse_thumb', 'Browse Image (thumbnail)'): [settings.PDS3_DATA_DIR+'/previews/COVIMS_0xxx/COVIMS_0006/data/2005015T175855_2005016T184233/v1484504505_4_thumb.png'], ('browse', 20, 'browse_small', 'Browse Image (small)'): [settings.PDS3_DATA_DIR+'/previews/COVIMS_0xxx/COVIMS_0006/data/2005015T175855_2005016T184233/v1484504505_4_small.png'], ('browse', 30, 'browse_medium', 'Browse Image (medium)'): [settings.PDS3_DATA_DIR+'/previews/COVIMS_0xxx/COVIMS_0006/data/2005015T175855_2005016T184233/v1484504505_4_med.png'], ('browse', 40, 'browse_full', 'Browse Image (full)'): [settings.PDS3_DATA_DIR+'/previews/COVIMS_0xxx/COVIMS_0006/data/2005015T175855_2005016T184233/v1484504505_4_full.png']}}, 'vg-iss-2-s-c4360048': {'Current': {('Voyager ISS', 0, 'vgiss_raw', 'Raw Image'): [settings.PDS3_DATA_DIR+'/volumes/VGISS_6xxx/VGISS_6210/DATA/C43600XX/C4360048_RAW.IMG', settings.PDS3_DATA_DIR+'/volumes/VGISS_6xxx/VGISS_6210/DATA/C43600XX/C4360048_RAW.LBL'], ('Voyager ISS', 10, 'vgiss_cleaned', 'Cleaned Image'): [settings.PDS3_DATA_DIR+'/volumes/VGISS_6xxx/VGISS_6210/DATA/C43600XX/C4360048_CLEANED.IMG', settings.PDS3_DATA_DIR+'/volumes/VGISS_6xxx/VGISS_6210/DATA/C43600XX/C4360048_CLEANED.LBL'], ('Voyager ISS', 20, 'vgiss_calib', 'Calibrated Image'): [settings.PDS3_DATA_DIR+'/volumes/VGISS_6xxx/VGISS_6210/DATA/C43600XX/C4360048_CALIB.IMG', settings.PDS3_DATA_DIR+'/volumes/VGISS_6xxx/VGISS_6210/DATA/C43600XX/C4360048_CALIB.LBL'], ('Voyager ISS', 30, 'vgiss_geomed', 'Geometrically Corrected Image'): [settings.PDS3_DATA_DIR+'/volumes/VGISS_6xxx/VGISS_6210/DATA/C43600XX/C4360048_GEOMED.IMG', settings.PDS3_DATA_DIR+'/volumes/VGISS_6xxx/VGISS_6210/DATA/C43600XX/C4360048_GEOMED.LBL'], ('Voyager ISS', 40, 'vgiss_resloc', 'Reseau Table'): [settings.PDS3_DATA_DIR+'/volumes/VGISS_6xxx/VGISS_6210/DATA/C43600XX/C4360048_RESLOC.TAB', settings.PDS3_DATA_DIR+'/volumes/VGISS_6xxx/VGISS_6210/DATA/C43600XX/C4360048_RESLOC.DAT', settings.PDS3_DATA_DIR+'/volumes/VGISS_6xxx/VGISS_6210/DATA/C43600XX/C4360048_RESLOC.LBL'], ('Voyager ISS', 50, 'vgiss_geoma', 'Geometric Tiepoint Table'): [settings.PDS3_DATA_DIR+'/volumes/VGISS_6xxx/VGISS_6210/DATA/C43600XX/C4360048_GEOMA.TAB', settings.PDS3_DATA_DIR+'/volumes/VGISS_6xxx/VGISS_6210/DATA/C43600XX/C4360048_GEOMA.DAT', settings.PDS3_DATA_DIR+'/volumes/VGISS_6xxx/VGISS_6210/DATA/C43600XX/C4360048_GEOMA.LBL'], ('Voyager ISS', 60, 'vgiss_raw_browse', 'Extra Preview (raw)'): [settings.PDS3_DATA_DIR+'/volumes/VGISS_6xxx/VGISS_6210/BROWSE/C43600XX/C4360048_RAW.JPG', settings.PDS3_DATA_DIR+'/volumes/VGISS_6xxx/VGISS_6210/BROWSE/C43600XX/C4360048_RAW.LBL'], ('Voyager ISS', 70, 'vgiss_cleaned_browse', 'Extra Preview (cleaned)'): [settings.PDS3_DATA_DIR+'/volumes/VGISS_6xxx/VGISS_6210/BROWSE/C43600XX/C4360048_CLEANED.JPG', settings.PDS3_DATA_DIR+'/volumes/VGISS_6xxx/VGISS_6210/BROWSE/C43600XX/C4360048_CLEANED.LBL'], ('Voyager ISS', 80, 'vgiss_calib_browse', 'Extra Preview (calibrated)'): [settings.PDS3_DATA_DIR+'/volumes/VGISS_6xxx/VGISS_6210/BROWSE/C43600XX/C4360048_CALIB.JPG', settings.PDS3_DATA_DIR+'/volumes/VGISS_6xxx/VGISS_6210/BROWSE/C43600XX/C4360048_CALIB.LBL'], ('Voyager ISS', 90, 'vgiss_geomed_browse', 'Extra Preview (geometrically corrected)'): [settings.PDS3_DATA_DIR+'/volumes/VGISS_6xxx/VGISS_6210/BROWSE/C43600XX/C4360048_GEOMED.JPG', settings.PDS3_DATA_DIR+'/volumes/VGISS_6xxx/VGISS_6210/BROWSE/C43600XX/C4360048_GEOMED.LBL'], ('Voyager ISS', 100, 'vgiss_documentation', 'Documentation'): [settings.PDS3_DATA_DIR+'/documents/VGISS_5xxx/VICAR-File-Format.pdf', settings.PDS3_DATA_DIR+'/documents/VGISS_5xxx/User-Tutorial.txt', settings.PDS3_DATA_DIR+'/documents/VGISS_5xxx/Saturn-Image-Anomalies.txt', settings.PDS3_DATA_DIR+'/documents/VGISS_5xxx/Jupiter-Image-Anomalies.txt', settings.PDS3_DATA_DIR+'/documents/VGISS_5xxx/Image-Processing.txt', settings.PDS3_DATA_DIR+'/documents/VGISS_5xxx/CDROM-Info.txt'], ('metadata', 5, 'rms_index', 'RMS Node Augmented Index'): [settings.PDS3_DATA_DIR+'/metadata/VGISS_6xxx/VGISS_6210/VGISS_6210_index.tab', settings.PDS3_DATA_DIR+'/metadata/VGISS_6xxx/VGISS_6210/VGISS_6210_index.lbl'], ('metadata', 7, 'raw_image_index', 'Raw Image Index'): [settings.PDS3_DATA_DIR+'/metadata/VGISS_6xxx/VGISS_6210/VGISS_6210_raw_image_index.tab', settings.PDS3_DATA_DIR+'/metadata/VGISS_6xxx/VGISS_6210/VGISS_6210_raw_image_index.lbl'], ('metadata', 8, 'supplemental_index', 'Supplemental Index'): [settings.PDS3_DATA_DIR+'/metadata/VGISS_6xxx/VGISS_6210/VGISS_6210_supplemental_index.tab', settings.PDS3_DATA_DIR+'/metadata/VGISS_6xxx/VGISS_6210/VGISS_6210_supplemental_index.lbl'], ('metadata', 10, 'inventory', 'Target Body Inventory'): [settings.PDS3_DATA_DIR+'/metadata/VGISS_6xxx/VGISS_6210/VGISS_6210_inventory.csv', settings.PDS3_DATA_DIR+'/metadata/VGISS_6xxx/VGISS_6210/VGISS_6210_inventory.lbl'], ('metadata', 20, 'planet_geometry', 'Planet Geometry Index'): [settings.PDS3_DATA_DIR+'/metadata/VGISS_6xxx/VGISS_6210/VGISS_6210_saturn_summary.tab', settings.PDS3_DATA_DIR+'/metadata/VGISS_6xxx/VGISS_6210/VGISS_6210_saturn_summary.lbl'], ('metadata', 50, 'ring_geometry', 'Ring Geometry Index'): [settings.PDS3_DATA_DIR+'/metadata/VGISS_6xxx/VGISS_6210/VGISS_6210_ring_summary.tab', settings.PDS3_DATA_DIR+'/metadata/VGISS_6xxx/VGISS_6210/VGISS_6210_ring_summary.lbl'], ('browse', 10, 'browse_thumb', 'Browse Image (thumbnail)'): [settings.PDS3_DATA_DIR+'/previews/VGISS_6xxx/VGISS_6210/DATA/C43600XX/C4360048_thumb.jpg'], ('browse', 20, 'browse_small', 'Browse Image (small)'): [settings.PDS3_DATA_DIR+'/previews/VGISS_6xxx/VGISS_6210/DATA/C43600XX/C4360048_small.jpg'], ('browse', 30, 'browse_medium', 'Browse Image (medium)'): [settings.PDS3_DATA_DIR+'/previews/VGISS_6xxx/VGISS_6210/DATA/C43600XX/C4360048_med.jpg'], ('browse', 40, 'browse_full', 'Browse Image (full)'): [settings.PDS3_DATA_DIR+'/previews/VGISS_6xxx/VGISS_6210/DATA/C43600XX/C4360048_full.jpg']}}}
        print('Got:')
        print(ret)
        print('Expected:')
        print(expected)
        self.assertEqual(dict(ret), dict(expected))
